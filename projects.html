<br>

<div>
    <table class = "sortable" border = "1">
        <thead>
            <th>Project</th>
            <th>Platform</th>
            <th>Languages</th>
            <th>Data Source</th>
            <th>Scale</th>
            <th>Organization</th>
            <th>Notes</th>
        </thead>
        <tbody>
            <tr>
                <td><a href="#" onclick="toggleExpFull('Datanets'), false">Datanets</a></td>
                <td>MS Access</td>
                <td>VBA, XML, Python</td>
                <td>Split Access Backend</td>
                <td>30k lines of code, 150+ tables</td>
                <td>CTRI</td>
                <td>Largest solo project</td>
            </tr>
            <tr>
                <td><a href="#" onclick="toggleExpFull('Disparities'), false">Disparities</a></td>
                <td>MS Access</td>
                <td>VBA</td>
                <td>SQL Backend, test and production environments</td>
                <td>Medium</td>
                <td>CTRI</td>
                <td>Reworked legacy code for new project.  Major overhall to front end</td>
            </tr>
        </tbody>
    </table>
</div>

<br>
<div>
    <!--Datanets Detail-->
    <div id =  "Datanets">
        <br>
        <hr class = "HeaderOutline">
        <button class = "toggleButton" id = "DatanetsSubBtn" onclick="toggleExp('Datanets')">-</button>
        <span class = "HeaderText"> The Datanets</span>
        <span class = "HeaderDetail" id = "DatanetsDetail" style = "display:none">
             <i>Access, VBA, Split Backend, Large Project </i> 
        </span>
        <hr class = "HeaderOutline">
        <br>

        <div id = "DatanetsSub"  class="experienceSub" style="display:block">
            <table>
                <tr>
                    <td class = "thStandard"><b>Platform:</b></td>
                    <td class = "tdStandard">MS Access</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Languages:</b></td>
                    <td class = "tdStandard">VBA, Pyhton, XML (Ribbon)</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Data Source:</b></td>
                    <td class = "tdStandard">Split Access Back-End</td>
                </tr>
                <tr>
                    <td class = "thStandard"> <b>Size:</b></td>
                    <td class = "tdStandard"> Large</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Organization:</b></td>
                    <td class = "tdStandard"> CTRI</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Notes:</b></td>
                    <td class = "tdStandard"> Largest solo project</td>
                </tr>
            </table>

            <p><b>Overview</b></p>
            <p> 
                One of the firsts tasks I was asked to perform on arrivale at CTRI was to develop an access application 
                that could track data dictionaries for datasets associated with the center.  The center runs numerous 
                concurrent studies ranging from tracking 20-30 participants over a couple of months up to tracking
                thousands of participants over the series of 1-3 years.  Studies could produce hundreds of raw datasets from
                many different sources, and the previous system of tracking via excel was getting out of hand. In addition
                to adding datasets, I added the ability to track the 'lineage' of datasets and variables. This allowed us
                to follow the progression of raw data through the cleaning process and into large analysis sets.
            </p>       
            <p>
                In my data management role it quickly became apparent that the center was running into issues with 
                consistancy among assesments.  Even within the same project an assessment with multiple time points asked
                the same question differently, both in terms of phrasing, and code book responses. It quickly became apparent
                that my application could do more to help the center.
            </p>
            <p>
                By linking the variables in the dataset to a unique list of variables (which we called 'meta' variabels), I 
                was able to add functionality to compare like variables against each other.  This was so successful that we moved
                the development of Qualtrics assesments into the Datanets, and added in the ability to export the created assessments
                into files that could be imported directly into Qualtrics.  This significantly improved consistancy, cut down on 
                transcription errors, and sped up project development. This also turned the Datanets into a multi-user project, with
                project management and the Qualtrics team as added users.
            </p>
            <p>
                All of our data cleaning and manipulation is handled through SPSS syntax.  This gives us an easy to follow
                (and justify) trail of how our data was processed. But developing syntax can be tedious and time consuming.
                Given that all of the data was already being tracked in the Datanets, the next logical step was to get the 
                datanets to automate significant aspects of the syntax development.  Initially this was doen through a simple
                form allowing me to select variables and run different operations to generate syntax (keep statements, recodes,
                value and variable labels, etc).  I then moved into creating SPSS syntax templates that could be manipulated
                in one easy step to generate the bulk of both the cleaning syntax, and the syntax necessary to generate merged
                analysis sets.  This greatly reduced the turn around time in the data management process, getting PIs qaulity 
                data faster. 
            </p>
            <p>
                Additional tools were added that allowed access to interface with SPSS via python scripts.  These tools included
                validating the variables in the Datanets matched the variables in the dataset, running syntax directly from the 
                Datanets, and importing data dictionaries directly from SPSS data files.
            </p>
            <p>
                The datanets quickly grew into the largest solo project I have ever produced.  It contains **stats** and provides
                tools in the following ares
                **tools**
            </p>
            
            <div class = "imageCaption"> 
                <div class = "imageContainer" id = "Datanets">
                    <img class="imageFill DatanetsSlides" 
                            id = "Datanets1" 
                            onclick="displayModal('Datanets1')"
                            src="assets/images/datanets/Datasets.PNG" 
                            alt = "Image 1">

                    <img class="imageFill DatanetsSlides" 
                            id = "Datanets2" 
                            onclick="displayModal('Datanets2')"
                            src="assets/images/datanets/DynamicRightClick.PNG" 
                            alt = "Image 2">

                    <img class="imageFill DatanetsSlides" 
                            id = "Datanets3" 
                            onclick="displayModal('Datanets3')"
                            src="assets/images/datanets/Meta.PNG" 
                            alt = "Image 3">

                    <img class="imageFill DatanetsSlides" 
                            id = "Datanets4" 
                            onclick="displayModal('Datanets4')"
                            src="assets/images/datanets/spssCodeGen.PNG" 
                            alt = "Image 4">
                </div>
                <div id = "DatanetsCounter" style="display:none">1</div>
                <br>
                <p id = "DatanetsCaption"></p>
                
                <button class="w3-button w3-display-left" onclick="plusDivs(-1, 'Datanets')">&#10094;</button>
                <button class="w3-button w3-display-right" onclick="plusDivs(+1, 'Datanets')">&#10095;</button>
            </div>
        </div>
        <br>
    </div>

    <!--sadf-->
    <div id =  "Disparities">
        <br>
        <hr class = "HeaderOutline">
        <button class = "toggleButton" id = "DisparitiesSubBtn" onclick="toggleExp('Disparities')">+</button>
        <span class = "HeaderText"> Disparities</span>
        <span class = "HeaderDetail" id = "DisparitiesDetail" style = "display:block">
                <i>Access, VBA, Rework of Legacy Database, SQL Backend </i> 
           </span>
        <hr class = "HeaderOutline">
        <br>

        <div id = "DisparitiesSub"  class="experienceSub" style="display:none">
            <p> Disparities</p>
            <table>
                <tr>
                    <td class = "thStandard"><b>Platform:</b></td>
                    <td class = "tdStandard">MS Access</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Languages:</b></td>
                    <td class = "tdStandard">VBA</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Data Source:</b></td>
                    <td class = "tdStandard">SQL Back-End</td>
                </tr>
                <tr>
                    <td class = "thStandard"> <b>Size:</b></td>
                    <td class = "tdStandard"> Medium</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Organization:</b></td>
                    <td class = "tdStandard"> CTRI</td>
                </tr>
                <tr>
                    <td class = "thStandard"><b>Notes:</b></td>
                    <td class = "tdStandard"> Rework of Legacy Code, focus on design</td>
                </tr>
            </table>

            <p><b>Overview</b></p>
            <p>
                Almost every clinical trial run at CTRI is accompanied by a project database. The databases, initially developed by
                our former DBA Paul Kohn, handle particpant screening, scheduling, daily call lists, appointment flowsheets (which 
                vary by condition and visit), assessments, payments, and reporting. Each project pulled components from prior project 
                DBs, but had to be modified to meet specific project requirements.
            </p>    
            <p>
                Prior to Pauls departure I was brought in to help with the development of the QUITS database, and after he left I was
                tasked with developing the new Disparities project.  Most of the work involved pulling components from multiple
                previous applications, and refactoring the code to get it all working together. One issue with previous projects was a 
                detached and clutered UI.  As part of this project I took the oppurtunity to clean up the  interface, improving usability
                and creating a cohesive application.
            </p>
            <p>
                One contribution I provided to QUITs and carried over to Disparities was the redevelopment of the 'Find A Person' form.
                The old form involved the development of multiple queries that were swapped out as search fields were changed.  This 
                approach, used throughout the project databases, was effecient under heavy load or for users with poor connectivity, but 
                having numerous queries involved in one form made modification a much more arduose process.  An alternative approach, 
                using immediate if statements, allows for quick modification, but slows down significantly under heavy use. To overcome 
                both of these issues I built a class that binds form fields directly to a base query and dynamically builds and modifies
                the query as search parameters change.  The bound fields can be used for either searching or sorting the associated 
                dataset. This approach has the added benefit of allowing for the dynamic and live swap of fields in the query and thier 
                bindings.  Drop downs on the Find A Person form, for example, allow you to swap between study status, email, and phone 
                number, using the same two buttons for searching and sorting depending on what is selected.  This made for quick loads, 
                easy modification, and fitting more fields in a limmited space. The easy initialization and binding allowed the class
                to be utilized as a template and implemented on other forms carrying out similar functionality. 
            </p>
            <p>

            </p>

            <div class = "imageCaption"> 
                <div class = "imageContainer" id = "Disparities">
                    <img class="imageFill DisparitiesSlides" 
                            id = "Disp1" 
                            onclick="displayModal('Disp1')"
                            src="assets/images/disparities/Menu_OldVsNew.PNG" 
                            alt = "Disparities (Top) Vs Legacy (Bottom) Menu">

                    <img class="imageFill DisparitiesSlides" 
                            id = "Disp2" 
                            onclick="displayModal('Disp2')"
                            src="assets/images/disparities/FindPerson_OldVsNew.PNG" 
                            alt = "Disparities (Top) Vs Legacy (Bottom) Find A Person">

                    <img class="imageFill DisparitiesSlides" 
                            id = "Disp3" 
                            onclick="displayModal('Disp3')"
                            src="assets/images/disparities/Demo_OldVsNew.PNG" 
                            alt = "Disparities (Top) Vs Legacy (Bottom) Demographics">
                    <img class="imageFill DisparitiesSlides" 
                        id = "Disp4" 
                        onclick="displayModal('Disp4')"
                        src="assets/images/disparities/Sched_OldVsNew.PNG" 
                        alt = "Disparities (Top) Vs Legacy (Bottom) Schedule">
                    <img class="imageFill DisparitiesSlides" 
                        id = "Disp5" 
                        onclick="displayModal('Disp5')"
                        src="assets/images/disparities/Flowsheet_OldVsNew.PNG" 
                        alt = "Disparities (Top) Vs Legacy (Bottom) Flowsheet">
                    <img class="imageFill DisparitiesSlides" 
                        id = "Disp6" 
                        onclick="displayModal('Disp6')"
                        src="assets/images/disparities/Qualtrics_OldVsNew.PNG" 
                        alt = "Disparities (Top) Vs Legacy (Bottom) Qualtrics flowsheet items">
                    <img class="imageFill DisparitiesSlides" 
                        id = "Disp7" 
                        onclick="displayModal('Disp7')"
                        src="assets/images/disparities/PaySubjects_OldVsNew.PNG" 
                        alt = "Disparities (Top) Vs Legacy (Bottom) Pay Subjects">
                    <img class="imageFill DisparitiesSlides" 
                        id = "Disp8" 
                        onclick="displayModal('Disp8')"
                        src="assets/images/disparities/FindPerson_NewAltSelections.PNG" 
                        alt = "Example of dynamic change to field binding in new find a person form">
                </div>
                <div id = "DisparitiesCounter" style="display:none">1</div>
                <br>
                <p id = "DisparitiesCaption"></p>
                
                <button class="w3-button w3-display-left" onclick="plusDivs(-1, 'Disparities')">&#10094;</button>
                <button class="w3-button w3-display-right" onclick="plusDivs(+1, 'Disparities')">&#10095;</button>
            </div>
        </div>
        <br>
    </div>

    <!--sadf-->
    <div id =  "IVRMon">
        <br>
        <hr class = "HeaderOutline">
        <button class = "toggleButton" id = "IVRMonSubBtn" onclick="toggleExp('IVRMon')">+</button>
        <span class = "HeaderText"> IVR Monitoring</span>
        <span class = "HeaderDetail" id = "IVRMonDetail" style = "display:block">
                <i>dotnet, c#, dynamic access to multiple projects via DAL, SQL Backend </i> 
            </span>
        <hr class = "HeaderOutline">
        <br>

        <div id = "IVRMonSub"  class="experienceSub" style="display:none">
            <p> IVR Monitoring</p>
        </div>

        <br>
    </div>
</div>

<!-- The Modal -->
<div id="myModal" class="modal">
    <span class="close">Ã—</span>
    <img class="modal-content" id="img01">
    <div id="caption"></div>
</div>

<script>


    //Slide show

    //Load slide show defaults
    $(function() {
        var mImgs = document.querySelectorAll(".imageContainer");
        //Loop through all image containers
        mImgs.forEach(element => {
            //call showDivs for the containerID
            console.log("ABout to run load elements for " + element.getAttribute('id'))
            showDivs(element.getAttribute('id'));
        });
    });

    $(function() {
        console.log('--->**changing isPaused to false')
        isPaused = false;
    });

    //showDivs(slideIndex);

    function plusDivs(n, contID) {
        //get index container
        console.log("ABout to run plusDivs for " + contID)
        var mIndexContainer = document.getElementById(contID + 'Counter');
        mIndexContainer.innerHTML =  (Number(mIndexContainer.innerHTML) +  Number(n)) ;
        console.log("...Plus divs changed counter to " + mIndexContainer.innerHTML)
        showDivs(contID);
    }

    //contID is the name of the container holding the images
    //counterID is the name of the container holding the counter
    function showDivs(contID) {
        var i;
        var nContainer = document.getElementById(contID + 'Counter');
        console.log("...Show Divs Counter is equal to " + Number(nContainer.innerHTML));
        var x = document.getElementsByClassName(contID + 'Slides');
        if (nContainer.innerHTML > x.length) {
            nContainer.innerHTML = 1
        } 
        if (nContainer.innerHTML < 1) {nContainer.innerHTML = x.length} ;
        console.log("...Post function Counter is equal to " + nContainer.innerHTML);
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none"; 
        }
        x[nContainer.innerHTML-1].style.display = "block"; 
        var nCaption = document.getElementById(contID + 'Caption');
        nCaption.innerHTML =  x[nContainer.innerHTML-1].getAttribute('alt');
    }

    


    //Modal View of Image
    var modalImg = document.getElementById("img01");
    var captionText = document.getElementById("caption");
    var modal = document.getElementById('myModal');

    function displayModal(imgID){
        // Get the modal
        
        console.log("displayModal sent " + imgID);
        // Get the image and insert it inside the modal - use its "alt" text as a caption
        var img = document.getElementById(imgID);
        
        modal.style.display = "block";
        modalImg.src = img.src;
        captionText.innerHTML = img.alt;
    }
    
    
    

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() { 
        modal.style.display = "none";
    }

</script>